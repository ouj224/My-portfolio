<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>PROJECT</title>
  <link href="style.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <header>
    <div class="header-container">
      <div class="logo"><a href="index.html">MY PORTFOLIO</a></div>
      <nav>
        <ul>
          <li><a href="about.html"><img src="images/icon_about.png" alt="about" class="menu-icon"> ABOUT</a></li>
          <li><a href="resume.html"><img src="images/icon_resume.png" alt="resume" class="menu-icon"> RESUME</a></li>
          <li><a href="project.html" class="active"><img src="images/icon_project.png" alt="project" class="menu-icon"> PROJECT</a></li>
          <li><a href="library.html"><img src="images/icon_library.png" alt="library" class="menu-icon"> LIBRARY</a></li>
          <li><a href="contact.html"><img src="images/icon_contact.png" alt="contact" class="menu-icon"> CONTACT</a></li>
          <li><a href="board.html"><img src="images/icon_board.png" alt="board" class="menu-icon"> BOARD</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="sub-banner">
    <h2>PROJECT</h2>
  </div>

  <div class="container">
    <div class="content-header" id="list-top">
      <h3>프로젝트 갤러리</h3>
      <p style="color:#666; font-size:0.9rem; margin-top:5px;">
        진행한 프로젝트의 결과물을 등록하고 확인하세요.
      </p>
    </div>
    
    <div id="project-grid" class="project-grid"></div>

    <hr style="margin: 40px 0; border:0; border-top:1px solid #eee;">

    <div class="upload-box" id="form-area">
      <h4 id="form-title"><i class="fas fa-pen"></i> 프로젝트 등록하기</h4>
      <input type="hidden" id="edit-id">
      
      <div class="input-group">
        <label for="p-image">파일 업로드 (이미지, PDF 등)</label>
        <input type="file" id="p-image" accept="image/*,.pdf,.zip,.rar,.7z,.doc,.docx,.hwp">
        <p id="file-info" style="font-size: 0.8rem; color: #888; margin-top: 5px;">* 업로드한 파일은 상세화면에서 다운로드할 수 있습니다.</p>
      </div>
      <div class="input-group">
        <label for="p-title">프로젝트 제목</label>
        <input type="text" id="p-title" placeholder="프로젝트 제목을 입력하세요">
      </div>
      <div class="input-group">
        <label for="p-desc">설명</label>
        <input type="text" id="p-desc" placeholder="프로젝트 설명을 입력하세요">
      </div>
      
      <div style="display: flex; gap: 10px;">
        <button onclick="handleProjectSubmit()" id="btn-submit" class="btn-upload">등록</button>
        <button onclick="resetForm()" id="btn-cancel" class="btn-upload" style="background-color: #666; display: none;">취소</button>
      </div>
    </div>
  </div>

  <div id="project-modal" class="modal-overlay">
    <div class="modal-content">
      <span class="close-modal" onclick="closeModal()">&times;</span>
      <div style="text-align: center;">
        <div id="modal-img-area" style="margin-bottom: 20px; height: 200px; display: flex; align-items: center; justify-content: center; background: #f8f8f8; border-radius: 8px;"></div>
        <h3 id="modal-title" style="color: #004098; font-size: 1.5rem; margin-bottom: 10px;">제목</h3>
        <p id="modal-desc" style="color: #555; line-height: 1.6;">설명</p>
        <a id="modal-download" href="#" class="btn-upload" style="display:inline-block; margin-top:15px; text-decoration:none;" download><i class="fas fa-download"></i> 다운로드</a>
        <p id="modal-no-file" style="display:none; color:#999; margin-top:20px;">첨부된 파일이 없습니다.</p>
      </div>
    </div>
  </div>

  <footer>
    <div class="footer-content">
      <div class="footer-info"><p>Copyright © 2025 All Rights Reserved.</p></div>
    </div>
  </footer>

  <script src="script.js"></script>
  <script>
    let projectList = [
      { id: 1, title: "객체지향 포트폴리오", desc: "HTML/CSS/JS 포트폴리오 사이트", type: 'web', file: null },
      { id: 2, title: "Node.js API 서버", desc: "Express 프레임워크 활용", type: 'server', file: null },
      { id: 3, title: "MongoDB 데이터베이스", desc: "NoSQL 데이터 모델링", type: 'db', file: null },
      { id: 4, title: "반응형 웹 디자인", desc: "모바일/태블릿 대응 UI", type: 'design', file: null }
    ];
    let nextId = 5;
    let editMode = false;
    let currentEditId = null;

    window.onload = function() { renderProjects(); };

    function renderProjects() {
      const grid = document.getElementById('project-grid');
      grid.innerHTML = '';
      projectList.forEach(data => createCardDOM(data, grid));
    }

    function createCardDOM(data, parent) {
      const card = document.createElement('div');
      card.className = 'project-card';
      let displayContent = '', modalIconHtml = '', fileUrl = '#';
      if (data.file) {
        fileUrl = URL.createObjectURL(data.file);
        if (data.file.type.startsWith('image/')) {
          displayContent = `<img src="${fileUrl}" alt="Img">`;
          modalIconHtml = `<img src="${fileUrl}" style="max-width:100%; max-height:100%; object-fit:contain;">`;
        } else {
          displayContent = `<div style="background:#f8f9fa; height:100%; display:flex; align-items:center; justify-content:center; flex-direction:column; color:#004098;"><i class="fas fa-file-alt" style="font-size:3rem;"></i><span style="font-size:0.8rem; margin-top:5px;">${data.file.name}</span></div>`;
          modalIconHtml = `<i class="fas fa-file-alt" style="font-size:5rem; color:#004098;"></i>`;
        }
      } else {
        let icon = 'fa-laptop-code';
        if (data.type === 'server') icon = 'fa-server';
        if (data.type === 'db') icon = 'fa-database';
        displayContent = `<div style="background:#f0f7ff; height:100%; display:flex; align-items:center; justify-content:center; color:#004098;"><i class="fas ${icon}" style="font-size:3rem;"></i></div>`;
        modalIconHtml = `<i class="fas ${icon}" style="font-size:5rem; color:#004098;"></i>`;
        fileUrl = null;
      }
      card.innerHTML = `
        <div class="img-wrapper">${displayContent}</div>
        <div class="card-actions">
          <div class="action-btn" onclick="startEdit(${data.id}); event.stopPropagation();" title="수정"><i class="fas fa-pen"></i></div>
          <div class="action-btn delete" onclick="deleteProject(${data.id}); event.stopPropagation();" title="삭제"><i class="fas fa-trash"></i></div>
        </div>
        <div class="card-body">
          <h5>${data.title}</h5>
          <p class="card-desc-preview" style="overflow:hidden; text-overflow:ellipsis; white-space:nowrap;">${data.desc}</p>
        </div>
      `;
      card.onclick = () => openModal(data.title, data.desc, modalIconHtml, fileUrl, data.file ? data.file.name : '');
      parent.prepend(card);
    }

    function handleProjectSubmit() {
      const title = document.getElementById('p-title').value;
      const desc = document.getElementById('p-desc').value;
      const fileInput = document.getElementById('p-image');
      if (!title) { alert("제목을 입력하세요."); return; }
      if (editMode) {
        const target = projectList.find(p => p.id === currentEditId);
        if (target) { target.title = title; target.desc = desc; if(fileInput.files.length) target.file = fileInput.files[0]; }
        alert("수정되었습니다.");
        resetForm(); 
      } else {
        projectList.push({ id: nextId++, title: title, desc: desc, file: fileInput.files[0] });
        document.getElementById('p-title').value = '';
        document.getElementById('p-desc').value = '';
        document.getElementById('p-image').value = '';
        renderProjects();
      }
    }

    function startEdit(id) {
      const target = projectList.find(p => p.id === id);
      if (!target) return;
      editMode = true; currentEditId = id;
      document.getElementById('p-title').value = target.title;
      document.getElementById('p-desc').value = target.desc;
      document.getElementById('file-info').innerText = "* 파일을 새로 업로드하면 기존 파일이 교체됩니다.";
      document.getElementById('form-title').innerHTML = `<i class="fas fa-edit"></i> 프로젝트 수정하기`;
      document.getElementById('btn-submit').innerText = "수정 완료";
      document.getElementById('btn-cancel').style.display = "inline-block";
      document.getElementById('form-area').scrollIntoView({ behavior: 'smooth' });
    }

    function deleteProject(id) { if(confirm("정말 삭제하시겠습니까?")) { projectList = projectList.filter(p => p.id !== id); renderProjects(); } }
    function resetForm() {
      editMode = false; currentEditId = null;
      document.getElementById('p-title').value=''; document.getElementById('p-desc').value=''; document.getElementById('p-image').value='';
      document.getElementById('file-info').innerText = "* 업로드한 파일은 상세화면에서 다운로드할 수 있습니다.";
      document.getElementById('form-title').innerHTML = `<i class="fas fa-pen"></i> 프로젝트 등록하기`;
      document.getElementById('btn-submit').innerText = "등록"; document.getElementById('btn-cancel').style.display = "none";
      document.getElementById('list-top').scrollIntoView({ behavior: 'smooth' });
      renderProjects();
    }
    function openModal(t,d,i,f,fn) {
      document.getElementById('modal-title').innerText=t; document.getElementById('modal-desc').innerText=d; document.getElementById('modal-img-area').innerHTML=i;
      const db = document.getElementById('modal-download');
      if(f && f !== '#'){ db.href=f; db.download=fn; db.style.display='inline-block'; document.getElementById('modal-no-file').style.display='none'; }
      else { db.style.display='none'; document.getElementById('modal-no-file').style.display='block'; }
      document.getElementById('project-modal').classList.add('open');
    }
    function closeModal() { document.getElementById('project-modal').classList.remove('open'); }
    window.onclick = function(e) { if(e.target==document.getElementById('project-modal')) closeModal(); }
  </script>
</body>
</html>